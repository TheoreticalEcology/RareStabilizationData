layout(matrix(1,2))
plot(compare$minT,compare$TempAirmin,xlab="Station Min T",ylab="Graph Min T",xlim=c(14,26),ylim=c(14,26),col="blue",cex=1.5);abline(0,1)
plot(compare$maxT,compare$TempAirmx,xlab="Station Max T",ylab="Graph Max T",xlim=c(29,42),ylim=c(29,42),col="red",cex=1.5);abline(0,1)
?layout
layout(matrix(1,1),1,2)
plot(compare$minT,compare$TempAirmin,xlab="Station Min T",ylab="Graph Min T",xlim=c(14,26),ylim=c(14,26),col="blue",cex=1.5);abline(0,1)
plot(compare$maxT,compare$TempAirmx,xlab="Station Max T",ylab="Graph Max T",xlim=c(29,42),ylim=c(29,42),col="red",cex=1.5);abline(0,1)
layout(matrix(c(1,1)),1,2)
plot(compare$minT,compare$TempAirmin,xlab="Station Min T",ylab="Graph Min T",xlim=c(14,26),ylim=c(14,26),col="blue",cex=1.5);abline(0,1)
plot(compare$maxT,compare$TempAirmx,xlab="Station Max T",ylab="Graph Max T",xlim=c(29,42),ylim=c(29,42),col="red",cex=1.5);abline(0,1)
layout(matrix(c(1,1),1,2))
plot(compare$minT,compare$TempAirmin,xlab="Station Min T",ylab="Graph Min T",xlim=c(14,26),ylim=c(14,26),col="blue",cex=1.5);abline(0,1)
plot(compare$maxT,compare$TempAirmx,xlab="Station Max T",ylab="Graph Max T",xlim=c(29,42),ylim=c(29,42),col="red",cex=1.5);abline(0,1)
matrix(c(1,1),1,2)
layout(matrix(c(1,1,0,2), 2, 2, byrow = TRUE))
plot(compare$minT,compare$TempAirmin,xlab="Station Min T",ylab="Graph Min T",xlim=c(14,26),ylim=c(14,26),col="blue",cex=1.5);abline(0,1)
plot(compare$maxT,compare$TempAirmx,xlab="Station Max T",ylab="Graph Max T",xlim=c(29,42),ylim=c(29,42),col="red",cex=1.5);abline(0,1)
layout(matrix(c(1,2),1,2))
plot(compare$minT,compare$TempAirmin,xlab="Station Min T",ylab="Graph Min T",xlim=c(14,26),ylim=c(14,26),col="blue",cex=1.5);abline(0,1)
plot(compare$maxT,compare$TempAirmx,xlab="Station Max T",ylab="Graph Max T",xlim=c(29,42),ylim=c(29,42),col="red",cex=1.5);abline(0,1)
View(monthly)
View(monthlyppt)
View(monthly)
relabunds=c(0.25,0.75)
#Scenario 1 - no NFD structure (10 species)
scen1b=rep(-1,2)
scen1a=-scen1b*relabunds
a=scen1a
b=scen1b
relabunds=c(0.25,0.75)
t=20
C=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C[1,-(1:3)]=1000*relabunds
C$Total[1]=sum(C[1,-(1:3)])
for(i in 1:t){
C$N1[i+1]=rpois(1,exp(b[1]*(C$N1[i]/C$Total[i])+a[1])*C$N1[i])
C$N2[i+1]=rpois(1,exp(b[2]*(C$N2[i]/C$Total[i])+a[2])*C$N2[i])
C$Total[i+1]=sum(C[i+1,-(1:3)],na.rm=T)
}
scenarioname=scenario1""
scenarioname="scenario1"
relabunds=c(0.25,0.75)
t=20
C=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C[1,-(1:3)]=1000*relabunds
C$Total[1]=sum(C[1,-(1:3)])
for(i in 1:t){
C$N1[i+1]=rpois(1,exp(b[1]*(C$N1[i]/C$Total[i])+a[1])*C$N1[i])
C$N2[i+1]=rpois(1,exp(b[2]*(C$N2[i]/C$Total[i])+a[2])*C$N2[i])
C$Total[i+1]=sum(C[i+1,-(1:3)],na.rm=T)
}
View(C)
relabunds2=c(0.75,0.25)
C2=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C[1,-(1:3)]=1000*relabunds2
C$Total[1]=sum(C[1,-(1:3)])
relabunds=c(0.25,0.75)
t=20
C=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C[1,-(1:3)]=1000*relabunds
C$Total[1]=sum(C[1,-(1:3)])
#Source community
relabunds2=c(0.75,0.25); b2=-1; a2=-b2*relabunds2
C2=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C2[1,-(1:3)]=1000*relabunds2
C2$Total[1]=sum(C2[1,-(1:3)])
relabunds=c(0.25,0.75)
t=20
C=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C[1,-(1:3)]=1000*relabunds
C$Total[1]=sum(C[1,-(1:3)])
#Source community
relabunds2=c(0.75,0.25); b2=-1; a2=-b2*relabunds2
C2=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C2[1,-(1:3)]=1000*relabunds2
C2$Total[1]=sum(C2[1,-(1:3)])
for(i in 1:t){
C$N1[i+1]=rpois(1,exp(b[1]*(C$N1[i]/C$Total[i])+a[1])*C$N1[i]) + .1*C2$N1[i] - .1*C$N1[i]
C$N2[i+1]=rpois(1,exp(b[2]*(C$N2[i]/C$Total[i])+a[2])*C$N2[i]) + .1*C2$N2[i] - .1*C$N2[i]
C$Total[i+1]=sum(C[i+1,-(1:3)],na.rm=T)
C2$N1[i+1]=rpois(1,exp(b2[1]*(C2$N1[i]/C2$Total[i])+a2[1])*C2$N1[i]) + .1*C$N1[i] - .1*C2$N1[i]
C2$N2[i+1]=rpois(1,exp(b2[2]*(C2$N2[i]/C2$Total[i])+a2[2])*C2$N2[i]) + .1*C$N2[i] - .1*C2$N2[i]
C2$Total[i+1]=sum(C2[i+1,-(1:3)],na.rm=T)
}
warnings()
View(C)
View(C2)
relabunds=c(0.25,0.75)
t=20
C=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C[1,-(1:3)]=1000*relabunds
C$Total[1]=sum(C[1,-(1:3)])
#Source community
relabunds2=c(0.75,0.25); b2=rep(-1,2); a2=-b2*relabunds2
C2=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1))
C2[1,-(1:3)]=1000*relabunds2
C2$Total[1]=sum(C2[1,-(1:3)])
for(i in 1:t){
C$N1[i+1]=rpois(1,exp(b[1]*(C$N1[i]/C$Total[i])+a[1])*C$N1[i]) + .1*C2$N1[i] - .1*C$N1[i]
C$N2[i+1]=rpois(1,exp(b[2]*(C$N2[i]/C$Total[i])+a[2])*C$N2[i]) + .1*C2$N2[i] - .1*C$N2[i]
C$Total[i+1]=sum(C[i+1,-(1:3)],na.rm=T)
C2$N1[i+1]=rpois(1,exp(b2[1]*(C2$N1[i]/C2$Total[i])+a2[1])*C2$N1[i]) + .1*C$N1[i] - .1*C2$N1[i]
C2$N2[i+1]=rpois(1,exp(b2[2]*(C2$N2[i]/C2$Total[i])+a2[2])*C2$N2[i]) + .1*C$N2[i] - .1*C2$N2[i]
C2$Total[i+1]=sum(C2[i+1,-(1:3)],na.rm=T)
}
View(C)
View(C2)
relabunds=c(0.25,0.75)
scen1b=rep(-1,2)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
setwd("C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData")
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 10 species, constant for all scenarios
relabunds=c(0.25,0.75)
#Scenario 1 - no NFD structure (10 species)
scen1b=rep(-1,2)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 10 species, constant for all scenarios
relabunds=c(0.25,0.75)
#Scenario 1 - no NFD structure (10 species)
scen1b=rep(-1,2)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
scen1a
scen1C
scen1obsA=sampling(C=scen1C, size=rep(1,10))
scen1obsA=sampling(C=scen1C, size=rep(1,2))
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/samplingfunction.R')
scen1obsA=sampling(C=scen1C, size=rep(1,2))
scen1resultsA=stabil(scen1obsA,sp_names=1:10,dataname="Scenario 1A (k=1)")
scen1obsA=sampling(C=scen1C, size=rep(1,2))
View(scen1obsA)
scen1resultsA=stabil(scen1obsA,sp_names=1:2,dataname="Scenario 1A (k=1)")
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/null_function.R')
scen1resultsA=stabil(scen1obsA,sp_names=1:2,dataname="Scenario 1A (k=1)")
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/null_function.R')
scen1resultsA=stabil(scen1obsA,sp_names=1:2,dataname="Scenario 1A (k=1)")
?foreach
install.packages("foreach")
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/null_function.R')
scen1resultsA=stabil(scen1obsA,sp_names=1:2,dataname="Scenario 1A (k=1)")
#################################Create 3 scenarios##########################################
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 10 species, constant for all scenarios
relabunds=c(0.25,0.75)
#Scenario 1 - no NFD structure (10 species)
scen1b=rep(-1,2)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
scen1obsA=sampling(C=scen1C, size=rep(1,2))
scen1resultsA=stabil(scen1obsA,sp_names=1:2,dataname="Scenario 1A (k=1)")
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/samplingfunction.R')
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 3 species, constant for all scenarios
relabunds=c(0.05,0.2,0.75)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-1,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
scen1obsA=sampling(C=scen1C, size=rep(1,3))
scen1resultsA=stabil(scen1obsA,sp_names=1:3,dataname="Scenario 1A (k=1)")
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 3 species, constant for all scenarios
relabunds=c(0.05,0.2,0.75)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-1,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
scen1obsA=sampling(C=scen1C, size=rep(1,3))
scen1resultsA=stabil(scen1obsA,sp_names=1:3,dataname="Scenario 1A (k=1)")
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 3 species, constant for all scenarios
relabunds=c(0.05,0.2,0.75)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-1,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
scen1obsA=sampling(C=scen1C, size=rep(1,3))
scen1resultsA=stabil(scen1obsA,sp_names=1:3,dataname="Scenario 1A (k=1)")
scen1obsB=sampling(C=scen1C, size=10*relabunds)
scen1resultsB=stabil(scen1obsB,sp_names=1:3,dataname="Scenario 1B (k=10*f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsB=stabil(scen1obsB,sp_names=1:3,dataname="Scenario 1B (k=10*f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:3,dataname="Scenario 1C (k=.1/f)")
scen1resultsC=stabil(scen1C,sp_names=1:3,dataname="Scenario 1 community")
scen1resultsC=stabil(scen1C,sp_names=1:3,dataname="Scenario 1 community")
scen1C=immigration("scenario1",scen1a,scen1b)
scen1resultsC=stabil(scen1C,sp_names=1:3,dataname="Scenario 1 community")
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
scen1C=immigration("scenario1",scen1a,scen1b)
scen1resultsC=stabil(scen1C,sp_names=1:3,dataname="Scenario 1 community")
scen1obsB=sampling(C=scen1C, size=10*relabunds)
scen1resultsB=stabil(scen1obsB,sp_names=1:3,dataname="Scenario 1B (k=10*f)")
scen1obsA=sampling(C=scen1C, size=rep(1,3))
scen1resultsA=stabil(scen1obsA,sp_names=1:3,dataname="Scenario 1A (k=1)")
scen1obsB=sampling(C=scen1C, size=10*relabunds)
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:3,dataname="Scenario 1C (k=.1/f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:3,dataname="Scenario 1C (k=.1/f)")
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
scen1C=immigration("scenario1",scen1a,scen1b)
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 3 species, constant for all scenarios
relabunds=c(0.05,0.2,0.75)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-1,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
View(scen1C)
scen1resultsC=stabil(scen1C,sp_names=1:3,dataname="Scenario 1 community")
scen1obsA=sampling(C=scen1C, size=rep(1,3))
scen1resultsA=stabil(scen1obsA,sp_names=1:3,dataname="Scenario 1A (k=1)")
scen1obsA=sampling(C=scen1C, size=rep(1,3))
scen1resultsA=stabil(scen1obsA,sp_names=1:3,dataname="Scenario 1A (k=1)")
scen1obsA=sampling(C=scen1C, size=rep(1,3))
scen1resultsA=stabil(scen1obsA,sp_names=1:3,dataname="Scenario 1A (k=1)")
scen1obsB=sampling(C=scen1C, size=10*relabunds)
scen1resultsB=stabil(scen1obsB,sp_names=1:3,dataname="Scenario 1B (k=10*f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:3,dataname="Scenario 1C (k=.1/f)")
layout(matrix(c(1,2,3,4),1,4))
color=c("springgreen4","royalblue3","tomato","tomato4","yellowgreen","purple4","springgreen",
"yellow2","thistle4","tan2","violetred3","turquoise1","rosybrown3","palevioletred4",
"tan4","violet","steelblue4","palevioletred3","thistle2","red4","seagreen4",
"rosybrown4","paleturquoise4","palegreen4","darksalmon",1:50)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
mtext(side=3,paste('1)','pattern=',round(lm(log(-scen1b)~log(relabunds))$coefficients[2],3),sep=' '),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
layout(rbind(1:4,5:8,9:12))
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsA[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling A (k=1)",cex.main=1.7)
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsA$Year,scen1obsA[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling B k = 10*f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsB[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling B (k=10*f)",cex.main=1.7)
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsB$Year,scen1obsB[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling C k = .1/f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsC[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling C (k=.1/f)",cex.main=1.7)
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsC$Year,scen1obsC[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
layout(matrix(c(1,2),1,2))
color=c("springgreen4","royalblue3","tomato","tomato4","yellowgreen","purple4","springgreen",
"yellow2","thistle4","tan2","violetred3","turquoise1","rosybrown3","palevioletred4",
"tan4","violet","steelblue4","palevioletred3","thistle2","red4","seagreen4",
"rosybrown4","paleturquoise4","palegreen4","darksalmon",1:50)
#Scenario 1 - no NFD structure (10 species)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
mtext(side=3,paste('1)','pattern=',round(lm(log(-scen1b)~log(relabunds))$coefficients[2],3),sep=' '),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
layout(matrix(1:3,1,3))
#Sampling A k = 1
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsA[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling A (k=1)",cex.main=1.7)
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsA$Year,scen1obsA[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling B k = 10*f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsB[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling B (k=10*f)",cex.main=1.7)
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsB$Year,scen1obsB[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling C k = .1/f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsC[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling C (k=.1/f)",cex.main=1.7)
mtext(side=3,expression(paste("1")),adj=0,line=0.5,cex=1.3); abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsC$Year,scen1obsC[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsA[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling A (k=1)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsA$Year,scen1obsA[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling B k = 10*f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsB[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling B (k=10*f)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsB$Year,scen1obsB[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling C k = .1/f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsC[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling C (k=.1/f)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsC$Year,scen1obsC[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
layout(matrix(c(1,2),1,2))
#Scenario 1 - no NFD structure (10 species)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
relabunds=c(0.05,0.2,0.75)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-1,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
scen1C=immigration("scenario1",scen1a,scen1b)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
relabunds=c(0.05,0.2,0.75)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-2,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsA[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling A (k=1)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsA$Year,scen1obsA[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling B k = 10*f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsB[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling B (k=10*f)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsB$Year,scen1obsB[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
scen1b=rep(-3,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
scen1b=rep(-3,3)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
C=data.frame(Year=1:(t+1),Site=scenarioname,Total=0,N1=rep(0,t+1),N2=rep(0,t+1),N3=rep(0,t+1),N4=rep(0,t+1),
N5=rep(0,t+1),N6=rep(0,t+1)),N7=rep(0,t+1),N8=rep(0,t+1),N9=rep(0,t+1),N9=rep(0,t+1))
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/samplingfunction.R')
t(relabunds)
relabunds=c(0.001,0.01,0.02,0.04,0.08,0.09,0.149,0.16,0.18,0.27)
relabunds
t(relabunds)
rev(relabunds)
source('C:/Users/gmyenni/Dropbox/projects/AssymetricNFD/RareStabilizationData/immigration.R')
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 3 species, constant for all scenarios
relabunds=c(0.001,0.01,0.02,0.04,0.08,0.09,0.149,0.16,0.18,0.27)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-1,10)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
layout(matrix(c(1,2),1,2))
#Scenario 1 - no NFD structure (10 species)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
scen1results=stabil(scen1C,sp_names=1:10,dataname="Scenario 1 real community")
scen1obsA=sampling(C=scen1C, size=rep(1,10))
scen1resultsA=stabil(scen1obsA,sp_names=1:10,dataname="Scenario 1A (k=1)")
scen1obsB=sampling(C=scen1C, size=10*relabunds)
scen1resultsB=stabil(scen1obsB,sp_names=1:10,dataname="Scenario 1B (k=10*f)")
scen1obsB=sampling(C=scen1C, size=10*relabunds)
scen1resultsB=stabil(scen1obsB,sp_names=1:10,dataname="Scenario 1B (k=10*f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:10,dataname="Scenario 1C (k=.1/f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:10,dataname="Sampling C (k=.1/f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:10,dataname="Sampling C (k=.1/f)")
source('./immigration.R')
source("./samplingfunction.r")
source("./stabil_function.r") #source stabil function with plotting turned on
#Set relative abundances for 3 species, constant for all scenarios
relabunds=c(0.001,0.01,0.02,0.04,0.08,0.09,0.149,0.16,0.18,0.27)
#Scenario 1 - no NFD structure (3 species)
scen1b=rep(-1,10)
scen1a=-scen1b*relabunds
scen1C=immigration("scenario1",scen1a,scen1b)
scen1results=stabil(scen1C,sp_names=1:10,dataname="Focal Community")
scen1obsA=sampling(C=scen1C, size=rep(1,10))
scen1resultsA=stabil(scen1obsA,sp_names=1:10,dataname="Sampling A (k=1)")
scen1obsB=sampling(C=scen1C, size=10*relabunds)
scen1resultsB=stabil(scen1obsB,sp_names=1:10,dataname="Sampling B (k=10*f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:10,dataname="Sampling C (k=.1/f)")
scen1obsC=sampling(C=scen1C, size=.1/relabunds)
scen1resultsC=stabil(scen1obsC,sp_names=1:10,dataname="Sampling C (k=.1/f)")
color=c("springgreen4","royalblue3","tomato","tomato4","yellowgreen","purple4","springgreen",
"yellow2","thistle4","tan2","violetred3","turquoise1","rosybrown3","palevioletred4",
"tan4","violet","steelblue4","palevioletred3","thistle2","red4","seagreen4",
"rosybrown4","paleturquoise4","palegreen4","darksalmon",1:50)
#############################Make scenario plots##################################
layout(matrix(c(1,2),1,2))
#Scenario 1 - no NFD structure (10 species)
plot(NA,NA,xlim=c(0,1), ylim=c(-1,1),xlab="Frequency",ylab="log lambda",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
abline(a=scen1a[i],b=scen1b[i],lwd=2,lty=i,col=color[i]) }
##############################Abundance Plots##########################################
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1C[,-(1:3)]),xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0))
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1C$Year,scen1C[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
##############################Observed Plots##########################################
layout(matrix(1:3,1,3))
#Sampling A k = 1
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsA[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling A (k=1)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsA$Year,scen1obsA[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling B k = 10*f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsB[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling B (k=10*f)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsB$Year,scen1obsB[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
#Sampling C k = .1/f
#Scenario 1 - no NFD structure (3 species)
plot(NA,NA,xlim=c(0,21), ylim=range(scen1obsC[,-(1:3)]), xlab="Time",ylab="N",cex.lab=1.7,cex.axis=1.5,tcl=0.2, mgp=c(2,0.5,0),main="Sampling C (k=.1/f)",cex.main=1.7)
abline(h=0,col="grey",lwd=2)
for(i in 1:length(relabunds)) {
points(scen1obsC$Year,scen1obsC[,i+3],lwd=2,lty=i,type="b",pch=i,col=color[i]) }
